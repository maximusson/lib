Function OnMenuCreate(Popup,Context)
'Event : before creation of context menu
'Input : Context -> Context menu object
'Context -> Context object from which the call is made.
'Context.ComosObject -> Current object or Context.ComosObjects -> Current objects
   
	' EXAMPLE :
	bAdd = AddPopupWithIconFromCOMOS(Popup, "Context Menu Text", "ID_COMOSICON", "std_zoomout")

End Function


Function AddPopupWithIconFromCOMOS(Popup, strContextText, strContextID, strIcon)
' DESCRIPTION : adds a popup to a given context menu with COMOS system icon

' SCRIPT REVISIONS :
' (1) 19-Feb-2019 : created
' (2) 19-May-2022 : beautify script
   
' INPUT :
' (1) Popup: Popup object - [comos system object]
' (2) strContextText: text that appears within context menu - [string]
' (3) strContextID: id for context menu entry, make sure it is unique - [string]
' (4) strIcon: icon name - [string]

' OUTPUT :
' (1) returns true if script ran completely [boolean]

	AddPopupWithIconFromCOMOS = false
	Popup.add strContextText, strContextID
	Popup.SetImage strContextID, strIcon
	AddPopupWithIconFromCOMOS = true

End Function


' untested icon paths
case
cdevice,j,@ddot
cdevice,j,1
cdevice,j,2
cdevice,j,3
cdevice,j,4
cdevice,j,f
cdevice,o
cdevice,r
cdevice,x,,v
cdevice,x
cdevice,z,,v
cdevice,z
cdevice
checked
colorbox,,,,0
colorbox,,,,16777215
colorbox
connector,b
connector,e
connector,f
connector,g
connector,i
connector,l
connector,p
connector,r
connector,s
connector,u
connector
d
ddmcheckedin
ddmcheckedout
ddmcheckedoutbyanotheruser
ddmfiledoesnotexists
ddmfilehistory
deref
device,%5b
device,a
device,b
device,c
device,d,,,255
device,d,c
device,d,g
device,d,o
device,d,p
device,d,s
device,d,x
device,d
device,e,i
device,e,l
device,e,t
device,e
device,f,h
device,f,u
device,f,w
device,f
device,g,,e
device,g
device,h
device,i,st
device,i
device,j,@ddot
device,j,1
device,j,2
device,j,3
device,j,4
device,j,f
device,j,j
device,j,k
device,j
device,k
device,l,m
device,l,n
device,l,r
device,l,y
device,l
device,m
device,n
device,o
device,p,%23
device,p,a
device,p,q
device,p
device,q
device,r
device,s
device,t
device,u
device,v
device,w
device,x
device,z
devsymbol
difpro
docobj
document,adobepdf
document,autocad
document,comosireport
document,comosmasterireport
document,comosmasterreport
document,comosreport
document,conval
document,conval_cfm
document,conval_cop
document,conval_cpr
document,conval_csr
document,conval_csz
document,conval_cwt
document,dgn
document,excel
document,excelx
document,generaldocument
document,jpgfile
document,msproject
document,msvisio
document,ole
document,package
document,powerpoint
document,powerpointx
document,proii
document,reference
document,text
document,undefine
document,word
document,wordx
document,xml-document
document,xml-template
document
e
exported
folder
grey
in
input
inputintrinsicalsafty
intrinsicalsafty
isrequest
l
language
link
mark
n
neutral
neutralintrinsicalsafty
nosymbol
nw
out
output
outputintrinsicalsafty
ownpointer
p
parameter
physunit
physunitgroup
project
projectwo
right
ro
root
specification,@c
specification
standardtable
standardvalue
std_runcase
user
usergroup
white
without
workingoverlay
coordsystem
iage_direct
pabase_aggregated_cmt
pcs7_cm_and
pcs7_cm_assignment
pcs7_cm_basic_requirement
pcs7_cm_nand
pcs7_cm_nor
pcs7_cm_not
pcs7_cm_or
pcs7_cm_standard
pcs7_cm_xor
pcs7_command
pcs7_control_module
pcs7_cv_paramter
pcs7_cv_paramter_ref
pcs7_cv_signal
pcs7_em_action
pcs7_em_condition
pcs7_em_jump
pcs7_em_seq_trigger
pcs7_eph_loop
pcs7_eph_parameter
pcs7_eph_parameter_description
pcs7_eph_parameter_folder
pcs7_eph_selection_sequence
pcs7_eph_sequence_chain
pcs7_eph_simultaneous_sequence
pcs7_eph_step
pcs7_eph_step_ref
pcs7_eph_step_sequence
pcs7_eph_transition
pcs7_eph_transition_sequence
pcs7_equipment_module
pcs7_equipment_phases
pcs7_generate_cmd_status_lib
pcs7_message
pcs7_status
std_@cpluginmacroblocks
std_@x.cplugin_ta_comparefingerprints
std_@x.cplugin_ta_createreferencefingerprint
std_@x.cplugin_ta_fingerprintsettings
std_@x.cpluginareimport.areimport
std_@x.cpluginautoassigndevto3d
std_@x.cplugincatap.catapclass
std_@x.cplugincatiainterface.catiainterface
std_@x.cplugincdi.cdi
std_@x.cplugincheckinstances.checkinstances
std_@x.cplugincheckproductd.checkproductd
std_@x.cplugincomosxmlie.comosxmlie
std_@x.cpluginconverttriga.converttriga
std_@x.cplugincopyclasses.copyclasses
std_@x.cplugincopyinproject.copyinprojectcls
std_@x.cplugind3erroranalyzer.d3erroranalyzer
std_@x.cplugindbconvert.dbconvert
std_@x.cplugindbperform.dbperform
std_@x.cplugindgnconfig.dgnconfig
std_@x.cplugindocdispatch.docdispatch
std_@x.cplugindocfileequal.docfileequal
std_@x.cplugindxfconfig.dxfconfig
std_@x.cpluginecadimp.ecadimpcls
std_@x.cpluginelmchk.elmchkcls
std_@x.cpluginelmmgr.elmmgr
std_@x.cpluginexcel.excel
std_@x.cpluginexf.exf
std_@x.cpluginfiletrans.filetrans
std_@x.cpluginfpsignals.fpsignalscls
std_@x.cpluginfulltextsearch.fulltextsearch
std_@x.cpluginiectojic.iectojic
std_@x.cpluginlangdb.langdb
std_@x.cpluginlanguagewizard.languagewizardcls
std_@x.cpluginlayerforsession.layerforsession
std_@x.cpluginloopmgr.loopmgrcls
std_@x.cpluginmail.mail
std_@x.cpluginmakonf.makonf
std_@x.cpluginmandcheckin.mandcheckin
std_@x.cpluginmntcorder.mntcorderclass
std_@x.cpluginmntcpreview.mntcpreviewclass
std_@x.cpluginmodnamelbl.modnamelbl
std_@x.cpluginoutlook.outlook
std_@x.cpluginperfmon.perfmoncls
std_@x.cpluginpipeclass.pipeclass
std_@x.cpluginplantrevs.plantrevs
std_@x.cpluginpotentialmgr.potentialmgr
std_@x.cpluginpowerpoint.powerpoint
std_@x.cpluginrema.remaclass
std_@x.cpluginruplanimport.ruplanimportcls
std_@x.cpluginsearchobject.searchobjectclass
std_@x.cpluginsearchproductd.searchproductd
std_@x.cpluginsetgeneralwire.setgeneralwire
std_@x.cpluginsmsconsole.smsconsoleplugin
std_@x.cpluginspcolorlegend.spcolorlegend
std_@x.cpluginstoremng.storemngclass
std_@x.cpluginsysmonitor.sysmonitor
std_@x.cplugintrdb.trdbcls
std_@x.cpluginunitconverter.unitconverter
std_@x.cpluginusersystem.usersystem
std_@x.cpluginvisio.visio
std_@x.cpluginvnsimport.vnsimportcls
std_@x.cpluginword.word
std_@x.cpluginzwd.zwd
std_@x.cplugpdmsinterface.pdmsinterface
std_3dsel32
std_abort
std_accessdb
std_actionerror
std_actionexecute
std_actionok
std_actionseverewarning
std_actionshow
std_actiontry
std_actionunfinished
std_actionwarning
std_actmerge2
std_adminlockedchildsoff
std_adminlockedchildson
std_aliascheck
std_aliasrouter
std_align
std_allchilds
std_allconnectors
std_alphabetic
std_alphanumeric
std_ansi
std_arc3p
std_archive
std_arcmp
std_arcround
std_arrangevertical
std_arrowdoublelightdown
std_arrowdoublelightleft
std_arrowdoublelightright
std_arrowdoublelightup
std_arrowlightdown
std_arrowlightdown_end
std_arrowlightleft
std_arrowlightright
std_arrowlightup
std_arrowlightup_end
std_ascending
std_ascendinggroup
std_assign
std_assignmappingtoprocesstagtemplate
std_assignprocesstagtype
std_attachment
std_autofind
std_autostructure
std_b0
std_backbycdevice
std_backbyspec
std_backtorequest
std_barcode
std_barter
std_barter2
std_beforesel32
std_behind32
std_birdview
std_bogen
std_bookmarkadd
std_bookmarkdelete
std_bookmarkshow
std_booland
std_boolnot
std_boolor
std_bracketclose
std_bracketopen
std_brazil
std_bridge_b0
std_bridge_b1
std_bridge_b1__a2
std_bridge_b1__t2
std_bridge_b1__t3
std_bridge_b1__t4
std_bridge_b1_m
std_bridge_b1_m_a1
std_bridge_b1_m_a2
std_bridge_b1_m_t2
std_bridge_b1_m_t3
std_bridge_b1_m_t4
std_bridge_b2
std_bridge_b2__t2
std_bridge_b2__t3
std_bridge_b2__t4
std_bridge_b3
std_bridge_b3__a2
std_bridge_b3__t2
std_bridge_b3__t3
std_bridge_b3__t4
std_bridge_b3_m
std_bridge_b3_m_a1
std_bridge_b3_m_a2
std_bridge_b3_m_t2
std_bridge_b3_m_t3
std_bridge_b3_m_t4
std_bridge_b4
std_bridge_b4__a2
std_bridge_b4__t2
std_bridge_b4__t3
std_bridge_b4__t4
std_bridge_b4_m
std_bridge_b4_m_a1
std_bridge_b4_m_a2
std_bridge_b4_m_t2
std_bridge_b4_m_t3
std_bridge_b4_m_t4
std_bridge_b5
std_bridge_b5__a2
std_bridge_b5_m
std_bridge_b5_m_a1
std_bridge_b5_m_a2
std_cab3d
std_cabinet
std_calculation
std_casp_fast
std_cateview
std_cboarrow
std_cdevices
std_changeview
std_checkboxchecked
std_checkboxunchecked
std_checked
std_checkeddisabled
std_checkin
std_checkin_white
std_checkout
std_checkradio
std_checkxdoc
std_childs
std_china
std_circle3p
std_circlemp
std_close
std_columndef
std_comos
std_comos_all_wh
std_comp_group
std_comp_group_hide
std_comp_obj
std_comp_obj_hide
std_connbusy
std_connected
std_connfree
std_conniso
std_connline
std_constr
std_construction
std_constrwhite
std_content
std_contentfix
std_controltype
std_copy
std_cpmschemaeditor
std_criticalpath
std_csv_export
std_csv_import
std_current
std_cut
std_d2
std_d3
std_d4
std_d5
std_d6
std_databaseopen
std_db
std_defaulttext2
std_delete
std_delete_pre
std_delete_suc
std_deletearraycons
std_deletemail
std_dereference
std_desc
std_descending
std_descendinggroup
std_design
std_design_off
std_detailwindow
std_deutsch
std_devedit
std_deveditn
std_devedittwo
std_devicednewplus
std_dimension
std_directwp
std_docquery
std_doctyp
std_documenttransfer_3
std_dqmexport
std_dqmfiletrans
std_dqmreload
std_drag
std_dragdrop
std_dragdropdisabled
std_draw
std_drun
std_drundoc
std_drundocandcontent
std_eblock
std_eblock_menu_optional_status_accept
std_eblock_menu_optional_status_deactivate
std_eblock_menu_optional_status_decline
std_eblock_status_executed_erroneous
std_eblock_status_executed_successfully
std_eblock_status_optional_declined
std_eblock_status_optional_executable
std_eblock_status_optional_inactive
std_eblock_status_optional_nonexecutable
std_eblock_status_regular_executable
std_eblock_status_regular_nonexecutable
std_eblock_status_regular_not_calculated
std_eblockassign
std_eblockexecute
std_eblockfind
std_eblockgroupview2
std_edit
std_editfileprops
std_elements
std_emfexport
std_english
std_eplandocument
std_eplanedit
std_eplanfacet
std_eplanproject
std_eplanwindowmacro
std_errorobjects
std_esign
std_evalobject
std_evalobjectbyvalue
std_evalvalue
std_eventeasy
std_eventinfo_set
std_eventmanag1
std_eventmanag2
std_eventstatus_set2
std_excel1
std_excel2
std_excel3
std_exceldb
std_excelexport_out
std_exclamation
std_exec
std_exit
std_export
std_export_document
std_export_simit
std_exportinspection
std_exportmenu
std_exportmenudoc
std_exportonly
std_exportpdms
std_exportreimport
std_extendedclasses
std_extras
std_fetchmail
std_field
std_filter
std_filterbymandate
std_filterbystatus
std_filterlist
std_filtersort
std_filterstdtable
std_find
std_findback
std_findfwd
std_firstofconnectedonly
std_firsttosecondforall
std_fitonscreen
std_fix_selection
std_folder
std_folderwithout
std_forward
std_france
std_free
std_gap32
std_general
std_generateeplan
std_generatepcs7
std_generatestep7
std_generatewincc
std_getexample
std_getformat
std_getmails
std_gl_abort
std_gl_absmove
std_gl_allconnector
std_gl_apap
std_gl_apnp
std_gl_autoconnector
std_gl_axes
std_gl_axispoint
std_gl_backspace
std_gl_bauteilrotate
std_gl_btnclip
std_gl_btnglobalviews
std_gl_btnpaint
std_gl_btnwalk
std_gl_clip
std_gl_connectpoint
std_gl_connectpoint_black
std_gl_connectpoint_white
std_gl_constructionpointssnap
std_gl_coordsystem
std_gl_coordsystemmove
std_gl_coordsystemmovey
std_gl_coordsystemmovez
std_gl_coordsystempos
std_gl_coordsystemposy
std_gl_coordsystemposz
std_gl_coordsystemrotate
std_gl_coordsystemrotatey
std_gl_coordsystemrotatez
std_gl_cut
std_gl_d3_centerview
std_gl_d3_rotateview
std_gl_d3_zoomview
std_gl_def_pipe
std_gl_device_z
std_gl_edit
std_gl_eloconnector
std_gl_exec
std_gl_f4
std_gl_glue
std_gl_grid
std_gl_helppoint
std_gl_id
std_gl_iso
std_gl_line
std_gl_mirror
std_gl_move
std_gl_moveto
std_gl_movey
std_gl_movez
std_gl_nogrid
std_gl_nord
std_gl_npap
std_gl_npnp
std_gl_nullpoint
std_gl_nullpointssnap
std_gl_ok
std_gl_pers1
std_gl_pipe1
std_gl_pipeconnector
std_gl_pipemode1
std_gl_pipemode2
std_gl_pipemode3
std_gl_pipemode4
std_gl_polygon
std_gl_position
std_gl_posy
std_gl_posz
std_gl_reset
std_gl_rotate
std_gl_rotatey
std_gl_rotatez
std_gl_setcoorsys
std_gl_snappointssnap
std_gl_steelconnector
std_gl_stretch
std_gl_surfacepoint
std_gl_transform
std_gl_uirotate
std_gl_usesecondpoint
std_gl_view0
std_gl_view2
std_gl_view3
std_gl_view4
std_gl_view5
std_gl_view6
std_gl_view7
std_gl_view8
std_gl_visiblegrid
std_gl_vnconnector
std_gl_walk
std_gl_xaxes
std_gl_yaxes
std_gminus
std_gplus
std_grafic
std_graph3d
std_grouptree
std_gsd_assign
std_headerfilter_active_12x12
std_headerfilter_inactive_12x12
std_headerfilter_set_12x12
std_help
std_helpbutton1
std_helpbutton2
std_helppdf
std_hierarchy
std_history
std_hline
std_hotkeys
std_hwconfig
std_iage
std_id
std_image_documentmanager
std_implement
std_import_document
std_import_excel_general
std_import_excel_loop
std_import_gsd
std_importcomos
std_importexport
std_importonly
std_importpool
std_includemainobject
std_inexcel
std_info
std_inherit
std_inheritance_break
std_inonly
std_inputmultiple
std_insert
std_insertcomment
std_inserttab
std_inspectiondiagramm
std_iso3d
std_iso3dreadonly
std_isogendimensionsandlabels
std_isosolve
std_isrequest
std_italy
std_k0
std_k1
std_language
std_layer1
std_layerforsession
std_licmnggen
std_licmngmon
std_licusermng
std_line
std_line1
std_line1a
std_line2
std_line3
std_line4
std_line5
std_line6
std_lineparam
std_linetypes
std_link
std_list
std_listingdonewithfaults
std_listingfault
std_listinginaction
std_listingok
std_listingopen
std_loadcate
std_locked
std_loctec1
std_loctec2
std_locteccheck1a
std_mail_done
std_mailboxfolder
std_mailboxmanager
std_mailin
std_mailout
std_mailout_new
std_mailoutforce
std_mailsettings
std_manhattan
std_mapto3d
std_matchtree
std_materialsourcing
std_milestone
std_mnfcatalog
std_mngjob
std_mngsys
std_mntcauto
std_montageext
std_more
std_move
std_move32
std_moveback32
std_mso07_excel
std_mso07_ppt
std_mso07_word
std_nav
std_nav_collapseall
std_nav_expandall
std_nav_flat
std_nav_groupbyextroo_grey
std_nav_groupbyextroot
std_nav_hierachy
std_nav_hierachyrecursive
std_nav_hierachyrecursive_grey
std_naviback
std_naviforward
std_navigate
std_navpred
std_navpred_data
std_navsucc
std_navsucc_data
std_networkdiagram
std_new
std_newdataset
std_newrev
std_next
std_nodraw
std_nosymbol
std_not
std_notchanged
std_notincludemainobject
std_notranslation
std_nullpoint
std_numberranges
std_numeric
std_oben
std_objbrwcoclass
std_objbrwconst
std_objbrwdll
std_objbrwenum
std_objbrwevent
std_objbrwfunction
std_objbrwinterface
std_objbrwmodul
std_objbrwocx
std_objbrwproperty
std_objbrwpropertyfolder
std_objbrwsub
std_objbrwtlbinfo
std_objbrwtypelib
std_objectauto
std_objectcheck
std_objectdebug
std_objectonly
std_open
std_openfolder
std_option
std_options
std_out
std_outonly
std_owner
std_pan
std_paste
std_pasteref
std_path
std_pcs7_enum_type
std_pcs7_enum_type_cont
std_pcs7_enum_value
std_pcs7_enum_value_green
std_pcs7_enum_value_invalid
std_pcs7_enum_value_o
std_pcs7_enum_value_r
std_pcs7_function_newnew
std_pcs7_glob_decl_cont
std_pcs7_importexport
std_pcs7_massnewconnections
std_pcs7_typkonfigurator
std_pcs7_varianten
std_pd
std_pdf
std_pdmsload
std_physunit
std_piadataexchange
std_picbox
std_picklist
std_pipeeasy
std_pipeeasyimportgraphic
std_pipeinspection
std_pipespecassign
std_pipespecassignmentcreate
std_pipespecassignmentdelete
std_planbasic
std_plandetail
std_poolopen
std_popupmenu
std_portugal
std_potential
std_print
std_print_pagebreakpreview
std_printc
std_printfolder
std_printrevisionfile
std_printtorevprinter
std_private
std_productcdevicenew
std_profilesave
std_projectclose
std_projectopen
std_properties
std_property_setting
std_propnav
std_proptree
std_pstream
std_qminus
std_qplus
std_querymenu
std_question
std_rcheckin
std_rect
std_redo
std_reflect
std_reflect32
std_refresh
std_refresh_general
std_refreshline
std_regexpipe
std_reimport
std_release
std_remove
std_remove32
std_removecomment
std_removetab
std_renumber
std_renumber_ans
std_renumber_iec
std_repaint
std_repdes_replacetext
std_reply
std_reportdesigner
std_reportfromxml
std_reporttodwg
std_reporttoexcel
std_reporttontr
std_reporttopdf
std_reporttoword
std_reporttoxml
std_reset
std_resettostart
std_resmon
std_restorewo
std_rev_adddoc
std_rev_adddoc_exp
std_rev_adddoc_imp
std_rev_addred
std_revision
std_rflist1
std_rflist2
std_rflist3
std_rflist4
std_rflist5
std_rflist6
std_rflist7
std_rflist8
std_rflist9
std_right
std_roles
std_rootin
std_rootout
std_rotate
std_rotl
std_rotr
std_rowdown
std_rowup
std_rtf
std_runbyerror
std_runtime
std_sap_connect
std_sap_disconnect
std_sap_ih
std_sap_ikonfig
std_sap_login
std_sap_sd
std_save
std_savedisabled
std_saveload
std_saveobjext
std_savetiff
std_scale
std_scaling_down_font
std_scaling_up_font
std_script
std_scriptadd
std_scriptauto
std_scriptstandard
std_search_translationdatabase
std_searchobj
std_searchopt
std_secondtofirstforall
std_select
std_select_cs
std_selectbutton
std_sendmail
std_setcdevice
std_setformat
std_shell
std_shiftmanag
std_shiftmanagementforce
std_show_all_direct_connections
std_show_layer
std_show_legend
std_showhistory
std_showname
std_shutd_mnu1
std_shutd_mnu2
std_signalmgr
std_signalno
std_simit_config
std_snapshot
std_spaceclose
std_spaceclose_all
std_spacepaste
std_specifcolumn
std_speclayout
std_speclikedevice
std_spi_importexport
std_split
std_stamper
std_statistic
std_status
std_status_error
std_status_info
std_status_ok
std_status_symbol_deleted
std_status_symbol_modified
std_status_symbol_new
std_status_symbol_unmodified
std_status_warning
std_statusdisplay
std_stdtbmgr
std_stop
std_stopbyerror
std_storemngin
std_storemngnew1
std_storemngout
std_stretch
std_stringdefinitionforobjectimport
std_subreport
std_subscript
std_sum
std_superscript
std_support
std_swapep
std_symboleditor
std_symbprev
std_syslockedchildsoff
std_syslockedchildson
std_systemobjno
std_systemobjyes
std_table
std_tables
std_tableview
std_tableviews
std_tag3d
std_template
std_template_change
std_template_create
std_template_update
std_textblockcenter
std_textblockleft
std_textblockright
std_textbold
std_textcolor
std_textdb
std_textdots
std_textitalic
std_textnumbers
std_textunderline
std_tif
std_time
std_timerange
std_traffic
std_traffica
std_trafficabort
std_trafficok
std_trafficselect
std_trafficstop
std_transform
std_translate
std_tree_down
std_tree_up
std_trianglefulldown
std_trianglefulldownwithbar
std_trianglefullleft
std_trianglefullright
std_trianglefullup
std_trianglefullupwithbar
std_unchecked
std_undo
std_undocheckout
std_ungarn
std_unknown
std_unlocked
std_unten
std_usa
std_use
std_usebyuse
std_user
std_userdefined
std_usermgr
std_userq
std_userset
std_value
std_valuefalseblack
std_valuetrueblack
std_view
std_viper_cm_1560
std_viper_cm_1561
std_viper_d3d
std_vline
std_warning
std_winccgen_autostructure
std_winccgen_color_picker
std_winccgen_constant
std_winccgen_no_preview
std_winccgen_placeholder
std_winccgen_screen
std_winccgen_screen_folder
std_winccgen_show_all_direct_connections
std_winccgen_show_layer
std_winccgen_show_legend
std_winccgen_tag
std_winccgen_tag_folder
std_windowlist
std_wmf
std_wo_bom_release
std_wo_clayercdev
std_wo_clayerdev
std_wo_softdeleted_remove
std_wo_statusview_refresh
std_word
std_workflowbutton1
std_workflowbutton2
std_workingoverlay
std_workingoverlay_filter
std_wostatusinfo
std_xfind
std_xmlnode
std_zoom
std_zoomin
std_zoominout
std_zoomout
